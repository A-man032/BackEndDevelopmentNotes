# MySQL

## 1. MySQL的客户端/服务端架构

**（类Unix系统）bin目录下启动MySQL服务器程序的可执行文件：**

- mysqld：MySQL服务器程序，运行这个可执行文件就可以直接启动一个MySQL服务器进程。但并不常用。

- mysqld_safe：一个启动脚本，间接调用mysqld并持续监视服务器的运行状态。当服务器进程出现错误，它可以帮助重启服务器程序。**使用mysqld_safe启动MySQL服务器程序，会将服务器程序的出错信息和其他诊断信息输出到错误日志。**

  > 出错日志默认写道一个以`.err`为扩展名的文件中，该文件位于MySQL的数据目录中。

- mysql.server：一个启动脚本，间接调用mysqld_safe。

- mysqld_multi：启动或停止多个服务器进程，也能报告它们的运行状态

- mysqld_safe、mysql.server和mysqld_multi本质上是一个Shell脚本

**bin目录下启动MySQL客户端程序的可执行文件：**

- mysql：通过这个可执行文件，可以与服务器程序交互，即发送请求并接收服务器的处理结果。

  ```
  // 启动mysql可执行文件的执行语句
  mysql -h主机名 -u用户名 -p密码
  ```

**客户端与服务器连接的过程：**

运行中的服务器程序和客户端程序本质上都是计算机上的一个进程，所以客户端进程向服务器进程发送请求并得到响应的过程本质上是一个进程间通信的过程。MySQL支持的客户端进程和服务器进程的通信方式有：**TCP/IP、命名管道和共享内存、UNIX域套接字**。

1. **TCP/IP**
   - MySQL采用TCP作为服务器和客户端之间的网络通信协议。
   - 在网络环境下，每台计算机都有一个唯一的IP地址，如果某个进程需要采用TCP协议进行网络通信，就可以向操作系统申请一个端口号。端口号是一个整数值，它的取值范围是0~65535。这样，网络中的其他进程就可以通过IP地址+端口号的方式与这个进程建立连接，这样进程之间就可以通过网络进行通信了。
   - MySQL服务器启动时会默认申请3306端口号。
2. **命名管道和共享内存**
   - Windows用户可以考虑在客户端进程和服务端进程之间使用命名管道或共享内存进行通信。
   - 使用共享内存进行通信的服务器进程和客户端进程必须位于同一台Windows主机中。
   - 命名管道和共享内存是Windows操作系统中的两种进程间通信方式。
3. **UNIX域套接字**
   - 服务器进程和客户端进程都运行在操作系统为类UNIX的同一台机器上，则可以使用UNIX域套接字进行进程间通信。

无论客户端进程和服务器进程采用哪种方式进行通信，最后实现的效果都是客户端进程向服务器进程发送一段文本（MySQL语句），服务器进程处理后再向客户端进程返回一段文本（处理结果）。

**服务器处理客户端请求大致分为3部分：**

1. 连接管理
   - 客户端可以采用TCP/IP、命名管道或共享内存、UNIX域套接字等几种方法与服务器进程建立连接。

